(function(e,d){var f=function(h,g,j){var i;return function(){function a(){if(!j){h.apply(c,b)}i=null}var c=this,b=arguments;if(i){clearTimeout(i)}else{if(j){h.apply(c,b)}}i=setTimeout(a,g||150)}};jQuery.fn[d]=function(b){return b?this.bind("resize",f(b)):this.trigger(d)}})(jQuery,"smartresize");(function(b){b.Gal=function(a,d){this.element=b(d);this._init(a)};b.Gal.settings={selector:".item",width:225,gutter:20,animate:false,animationOptions:{speed:200,duration:300,effect:"fadeInOnAppear",queue:true,complete:function(){}}};b.Gal.prototype={_init:function(a){var d=this;this.name=this._setName(5);this.gridArr=[];this.gridArrAppend=[];this.gridArrPrepend=[];this.setArr=false;this.setGrid=false;this.setOptions;this.cols=0;this.itemCount=0;this.prependCount=0;this.isPrepending=false;this.appendCount=0;this.resetCount=true;this.ifCallback=true;this.box=this.element;this.options=b.extend(true,{},b.Gal.settings,a);this.gridArr=b.makeArray(this.box.find(this.options.selector));this.isResizing=false;this.w=0;this.boxArr=[];this._setCols();this._renderGrid("append");b(this.box).addClass("gridalicious");b(window).smartresize(function(){d.resize()})},_setName:function(d,c){c=c?c:"";return d?this._setName(--d,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".charAt(Math.floor(Math.random()*60))+c):c},_setCols:function(){this.cols=Math.floor(this.box.width()/this.options.width);diff=(this.box.width()-this.cols*this.options.width-this.options.gutter)/this.cols;w=(this.options.width+diff)/this.box.width()*100;this.w=w;for(var a=0;a<this.cols;a++){var f=b("<div></div>").addClass("galcolumn").attr("id","item"+a+this.name).css({width:w+"%",paddingLeft:this.options.gutter,paddingBottom:this.options.gutter,"float":"left","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","-o-box-sizing":"border-box","box-sizing":"border-box"});this.box.append(f)}this.box.find(b("#clear"+this.name)).remove();var e=b("<div></div>").css({clear:"both",height:"0",width:"0",display:"block"}).attr("id","clear"+this.name);this.box.append(e)},_renderGrid:function(E,D,C,B){var A=[];var z=[];var y=[];var x=0;var v=this.prependCount;var u=this.appendCount;var t=this.options.gutter;var s=this.cols;var r=this.name;var q=0;var a=b(".galcolumn").width();if(D){z=D;if(E=="append"){u+=C;x=this.appendCount}if(E=="prepend"){this.isPrepending=true;x=Math.round(C%s);if(x<=0){x=s}}if(E=="renderAfterPrepend"){u+=C;x=C}}else{z=this.gridArr;u=b(this.gridArr).size()}b.each(z,function(j,i){var h=b(i);var f="100%";if(h.hasClass("not-responsive")){f="auto"}h.css({marginBottom:t,zoom:"1",filter:"alpha(opacity=0)",opacity:"0"}).find("img, object, embed, iframe").css({});if(E=="prepend"){x--;b("#item"+x+r).prepend(h);A.push(h);if(x==0){x=s}}else{b("#item"+x+r).append(h);A.push(h);x++;if(x>=s){x=0}if(u>=s){u=u-s}}});this.appendCount=u;this.itemCount=x;if(E=="append"||E=="prepend"){if(E=="prepend"){this._updateAfterPrepend(this.gridArr,z)}this._renderItem(A);this.isPrepending=false}else{this._renderItem(this.gridArr)}},_collectItems:function(){var a=[];b(this.box).find(this.options.selector).each(function(d){a.push(b(this))});return a},_renderItem:function(r){var q=this.options.animationOptions.speed;var p=this.options.animationOptions.effect;var o=this.options.animationOptions.duration;var n=this.options.animationOptions.queue;var m=this.options.animate;var l=this.options.animationOptions.complete;var k=0;var a=0;if(m===true&&!this.isResizing){if(n===true&&p=="fadeInOnAppear"){if(this.isPrepending){r.reverse()}b.each(r,function(e,c){setTimeout(function(){b(c).animate({opacity:"1.0"},o);a++;if(a==r.length){l.call(undefined,r)}},k*q);k++})}else{if(n===false&&p=="fadeInOnAppear"){if(this.isPrepending){r.reverse()}b.each(r,function(f,e){b(e).animate({opacity:"1.0"},o);a++;if(a==r.length){if(this.ifCallback){l.call(undefined,r)}}})}}if(n===true&&!p){b.each(r,function(f,e){b(e).css({opacity:"1",filter:"alpha(opacity=1)"});a++;if(a==r.length){if(this.ifCallback){l.call(undefined,r)}}})}}else{b.each(r,function(d,e){b(e).css({opacity:"1",filter:"alpha(opacity=1)"})});if(this.ifCallback){l.call(r)}}},_updateAfterPrepend:function(a,f){var e=this.gridArr;b.each(f,function(d,c){e.unshift(c)});this.gridArr=e},resize:function(){this.box.find(b(".galcolumn")).remove();this._setCols();this.ifCallback=false;this.isResizing=true;this._renderGrid("append");this.ifCallback=true;this.isResizing=false},append:function(a){var f=this.gridArr;var e=this.gridArrPrepend;b.each(a,function(d,c){f.push(c);e.push(c)});this._renderGrid("append",a,b(a).size())},prepend:function(a){this.ifCallback=false;this._renderGrid("prepend",a,b(a).size());this.ifCallback=true}};b.fn.gridalicious=function(a,d){if(typeof a==="string"){this.each(function(){var c=b.data(this,"gridalicious");c[a].apply(c,[d])})}else{this.each(function(){b.data(this,"gridalicious",new b.Gal(a,this))})}return this}})(jQuery);